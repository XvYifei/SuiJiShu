<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>PWAæ‰‹åŠ¿è¯†åˆ« - iOS 13å…¼å®¹ç‰ˆ</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            touch-action: none; /* ç¦ç”¨é»˜è®¤è§¦æ‘¸è¡Œä¸º */
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            position: relative;
        }
        
        .header {
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 500px;
            line-height: 1.5;
        }
        
        .gesture-area {
            width: 280px;
            height: 280px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            margin: 20px 0 40px;
            position: relative;
            overflow: hidden;
        }
        
        .gesture-area::before {
            content: '';
            position: absolute;
            width: 150%;
            height: 150%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .gesture-text {
            font-size: 3.5rem;
            font-weight: bold;
            z-index: 10;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transition: transform 0.3s ease;
        }
        
        .gesture-hint {
            margin-top: 15px;
            font-size: 1.1rem;
            opacity: 0.7;
            z-index: 10;
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            max-width: 500px;
            margin-top: 20px;
        }
        
        .instructions h2 {
            font-size: 1.4rem;
            margin-bottom: 15px;
        }
        
        .instruction-item {
            display: flex;
            align-items: center;
            margin: 12px 0;
            font-size: 1rem;
        }
        
        .icon {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 15px;
            font-size: 1.4rem;
        }
        
        .counter {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 8px 15px;
            font-size: 0.9rem;
        }
        
        .feedback {
            position: absolute;
            font-size: 2rem;
            font-weight: bold;
            opacity: 0;
            pointer-events: none;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
            z-index: 20;
            transition: opacity 0.3s;
        }
        
        .status {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 8px 15px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #4caf50;
            margin-right: 8px;
            box-shadow: 0 0 8px #4caf50;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 500px) {
            h1 { font-size: 1.8rem; }
            .gesture-area { width: 250px; height: 250px; }
            .gesture-text { font-size: 3rem; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>PWAæ‰‹åŠ¿è¯†åˆ«</h1>
        <p class="subtitle">å…¼å®¹iOS 13çš„ç‚¹å‡»ä¸ä¸Šæ»‘æ‰‹åŠ¿æ£€æµ‹ï¼Œè§£å†³é¡µé¢è·Ÿéšæ»šåŠ¨é—®é¢˜</p>
    </div>
    
    <div class="gesture-area" id="gestureArea">
        <div class="gesture-text" id="gestureText">ğŸ‘†</div>
        <div class="gesture-hint">åœ¨æ­¤åŒºåŸŸç‚¹å‡»æˆ–ä¸Šæ»‘</div>
    </div>
    
    <div class="instructions">
        <h2>ä½¿ç”¨è¯´æ˜</h2>
        <div class="instruction-item">
            <div class="icon">ğŸ’¡</div>
            <div>ç‚¹å‡»ä¸­é—´åŒºåŸŸ - æ˜¾ç¤º"ç‚¹å‡»"åé¦ˆ</div>
        </div>
        <div class="instruction-item">
            <div class="icon">ğŸ–ï¸</div>
            <div>ä»ä¸‹å‘ä¸Šæ»‘åŠ¨ - æ˜¾ç¤º"ä¸Šæ»‘"åé¦ˆ</div>
        </div>
        <div class="instruction-item">
            <div class="icon">âœ…</div>
            <div>å·²è§£å†³iOS 13é¡µé¢è·Ÿéšæ»šåŠ¨é—®é¢˜</div>
        </div>
    </div>
    
    <div class="counter">
        ç‚¹å‡»: <span id="clickCount">0</span> | 
        ä¸Šæ»‘: <span id="swipeCount">0</span>
    </div>
    
    <div class="status">
        <div class="status-dot"></div>
        <span>iOS 13å…¼å®¹æ¨¡å¼</span>
    </div>
    
    <script>
        // è·å–DOMå…ƒç´ 
        const gestureArea = document.getElementById('gestureArea');
        const gestureText = document.getElementById('gestureText');
        const clickCountEl = document.getElementById('clickCount');
        const swipeCountEl = document.getElementById('swipeCount');
        
        // åˆå§‹åŒ–è®¡æ•°å™¨
        let clickCount = 0;
        let swipeCount = 0;
        
        // è§¦æ‘¸å¼€å§‹ä½ç½®
        let touchStartY = 0;
        let touchStartTime = 0;
        
        // æ˜¾ç¤ºåé¦ˆåŠ¨ç”»
        function showFeedback(text, x, y) {
            const feedback = document.createElement('div');
            feedback.className = 'feedback';
            feedback.textContent = text;
            feedback.style.left = `${x}px`;
            feedback.style.top = `${y}px`;
            feedback.style.opacity = '1';
            
            document.body.appendChild(feedback);
            
            // åŠ¨ç”»æ•ˆæœ
            setTimeout(() => {
                feedback.style.transform = 'translateY(-30px)';
                feedback.style.opacity = '0';
            }, 100);
            
            // ç§»é™¤å…ƒç´ 
            setTimeout(() => {
                document.body.removeChild(feedback);
            }, 1000);
        }
        
        // è§¦æ‘¸å¼€å§‹äº‹ä»¶
        gestureArea.addEventListener('touchstart', function(e) {
            touchStartY = e.touches[0].clientY;
            touchStartTime = new Date().getTime();
            
            // æ·»åŠ æŒ‰å‹æ•ˆæœ
            gestureArea.style.transform = 'scale(0.95)';
            gestureArea.style.opacity = '0.9';
        });
        
        // è§¦æ‘¸ç§»åŠ¨äº‹ä»¶ - é˜»æ­¢é»˜è®¤è¡Œä¸ºé˜²æ­¢é¡µé¢æ»šåŠ¨
        gestureArea.addEventListener('touchmove', function(e) {
            e.preventDefault();
        }, { passive: false });
        
        // è§¦æ‘¸ç»“æŸäº‹ä»¶
        gestureArea.addEventListener('touchend', function(e) {
            const touchEndY = e.changedTouches[0].clientY;
            const touchEndTime = new Date().getTime();
            const timeDiff = touchEndTime - touchStartTime;
            
            // ç§»é™¤æŒ‰å‹æ•ˆæœ
            gestureArea.style.transform = 'scale(1)';
            gestureArea.style.opacity = '1';
            
            // è®¡ç®—æ»‘åŠ¨è·ç¦»å’Œæ—¶é—´
            const distanceY = touchEndY - touchStartY;
            const isSwipe = Math.abs(distanceY) > 10; // æ»‘åŠ¨é˜ˆå€¼
            
            // å¦‚æœæ˜¯ä¸Šæ»‘æ‰‹åŠ¿ (å‘ä¸Šæ»‘åŠ¨ä¸”è·ç¦»è¶³å¤Ÿ)
            if (isSwipe && distanceY < 0) {
                swipeCount++;
                swipeCountEl.textContent = swipeCount;
                gestureText.textContent = 'â†‘';
                
                // æ˜¾ç¤ºåé¦ˆ
                const rect = gestureArea.getBoundingClientRect();
                const x = rect.left + rect.width/2;
                const y = rect.top + rect.height/2;
                showFeedback('ä¸Šæ»‘', x, y);
            } 
            // å¦‚æœæ˜¯ç‚¹å‡»æ‰‹åŠ¿ (ç§»åŠ¨è·ç¦»å°ä¸”æ—¶é—´çŸ­)
            else if (!isSwipe && timeDiff < 300) {
                clickCount++;
                clickCountEl.textContent = clickCount;
                gestureText.textContent = 'â—';
                
                // æ˜¾ç¤ºåé¦ˆ
                const rect = gestureArea.getBoundingClientRect();
                const x = rect.left + rect.width/2;
                const y = rect.top + rect.height/2;
                showFeedback('ç‚¹å‡»', x, y);
            }
        });
        
        // é˜²æ­¢iOSæ©¡çš®ç­‹æ•ˆæœ
        document.body.addEventListener('touchmove', function(e) {
            if (e.scale !== 1) {
                e.preventDefault();
            }
        }, { passive: false });
        
        // æ³¨å†ŒService Worker (PWAåŠŸèƒ½)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js').then(registration => {
                    console.log('ServiceWorkeræ³¨å†ŒæˆåŠŸ:', registration.scope);
                }).catch(error => {
                    console.log('ServiceWorkeræ³¨å†Œå¤±è´¥:', error);
                });
            });
        }
        
        // æ·»åŠ åˆ°ä¸»å±å¹•æç¤º
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            console.log('PWAå¯å®‰è£…');
        });
    </script>
</body>
</html>